"use strict";!function(e){var n,t=e.document,o=e.window,i=t.createElement("canvas"),s=i.getContext("2d");function a(){var t,e=Date.now();t=(e-n)/1e3,allEnemies.forEach(function(e){e.update(t)}),player.update(),function(){var e,t,n=["images/water-block.png","images/stone-block.png","images/stone-block.png","images/stone-block.png","images/stone-block.png","images/stone-block.png","images/grass-block.png"];for(s.clearRect(0,0,i.width,i.height),e=0;e<7;e++)for(t=0;t<11;t++)s.drawImage(Resources.get(n[e]),101*t,83*e);allEnemies.forEach(function(e){e.render()}),player.render()}(),n=e,o.requestAnimationFrame(a)}i.width=1111,i.height=686,t.body.appendChild(i),Resources.load(["images/stone-block.png","images/water-block.png","images/grass-block.png","images/enemy-bug.png","images/char-boy.png"]),Resources.onReady(function(){n=Date.now(),a()}),e.ctx=s}(void 0),function(){var n={},o=[];function t(e){if(n[e])return n[e];var t=new Image;t.onload=function(){n[e]=t,i()&&o.forEach(function(e){e()})},n[e]=!1,t.src=e}function i(){var e=!0;for(var t in n)n.hasOwnProperty(t)&&!n[t]&&(e=!1);return e}window.Resources={load:function(e){e instanceof Array?e.forEach(function(e){t(e)}):t(e)},get:function(e){return n[e]},onReady:function(e){o.push(e)},isReady:i}}();var baseSpeed=30,timeBetweenEnemies=3e3,Enemy=function(e,t){this.x=0,this.y=60+80*e,this.speed=t,this.sprite="images/enemy-bug.png"};Enemy.prototype.update=function(e){this.x+=this.speed*e,this.x+75>player.x&&this.x-75<player.x&&this.y+30>player.y&&this.y-30<player.y&&(player.loosePoints(),player.moveToBeginning())},Enemy.prototype.render=function(){ctx.drawImage(Resources.get(this.sprite),this.x,this.y)};var Player=function(){this.x=505,this.y=483,this.score=0,this.sprite="images/char-boy.png"};Player.prototype.update=function(){},Player.prototype.render=function(){ctx.drawImage(Resources.get(this.sprite),this.x,this.y)},Player.prototype.handleInput=function(e){switch(e){case"left":0<this.x&&(this.x-=101);break;case"up":0<this.y&&(this.y-=83),this.checkIfWin();break;case"right":this.x<1e3&&(this.x+=101);break;case"down":this.y<460&&(this.y+=83)}},Player.prototype.checkIfWin=function(){this.y<0&&(this.moveToBeginning(),this.score+=100,baseSpeed+=15,clearInterval(enemyInterval),400<timeBetweenEnemies&&(timeBetweenEnemies-=100),createNewEnemy(),enemyInterval=setInterval(createNewEnemy,timeBetweenEnemies),document.getElementById("score").innerHTML=this.score,document.getElementById("you-win").style.opacity="1",setTimeout(function(){document.getElementById("you-win").style.opacity="0"},700))},Player.prototype.moveToBeginning=function(){this.x=505,this.y=483},Player.prototype.loosePoints=function(){baseSpeed-=15,timeBetweenEnemies+=100,this.score-=100,document.getElementById("score").innerHTML=this.score,document.getElementById("you-loose").style.opacity="1",setTimeout(function(){document.getElementById("you-loose").style.opacity="0"},700)};var allEnemies=[],enemyInterval=setInterval(createNewEnemy,timeBetweenEnemies);function createNewEnemy(){var e=70*Math.random()+baseSpeed,t=Math.trunc(5*Math.random());allEnemies.push(new Enemy(t,e))}createNewEnemy();var player=new Player;document.getElementById("score").innerHTML=player.score,document.addEventListener("keyup",function(e){player.handleInput({37:"left",38:"up",39:"right",40:"down"}[e.keyCode])});